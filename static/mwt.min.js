/*! mwt.min.js v3.3 | (c) 2013-2016,mawentao | release:2016-09-09 14:16:39 */
function number_format(e,t){var i=",";var r=3;var s="";e=parseFloat(e);e=e.toFixed(t);var a=e.split(".")[0];var n=e.split(".")[1];var l=a.split("");for(var o=1;o<=l.length;o++){s=l[l.length-o]+s;if(o%r==0){s=i+s}}s=a.length%r==0?s.substr(1):s;a=s+"."+n;if(!n)a=s;return a}function time(){var e=new Date;var t=e.getTime()/1e3;return Math.ceil(t)}function strtotime(e){e=e.replace(/-/g,"/");var t=new Date(e);var i=t.getTime()/1e3;return Math.ceil(i)}function date(e,t){var i=new Date;if(t)i=new Date(t*1e3);var r={"Y+":i.getFullYear(),"m+":i.getMonth()+1,"d+":i.getDate(),"H+":i.getHours(),"i+":i.getMinutes(),"s+":i.getSeconds(),"w+":i.getDay()};for(var s in r){if(new RegExp("("+s+")").test(e)){var a=r[s]+"";if(a.length==1)a="0"+a;e=e.replace(RegExp.$1,a)}}return e}function in_array(e,t){var i=t.length;for(var r=0;r<i;++r)if(t[r]==e)return true;return false}function array_keys(e){var t=[];for(var i in e)t.push(i);return t}function json2str(e,t){var i="";t||(t=1);var r=new Array(4*(t-1)).join(" ");var s=new Array(4*t).join(" ");var a="";var n=typeof e;switch(n){case"string":case"number":case"boolean":case"undefined":case"function":a+=e;break;case"object":default:for(var l in e){a+=s+"["+l+"] = ";a+=json2str(e[l],t+1)}}if(n=="object"){i+=n+"\n";i+=r+"("+"\n";i+=a;i+=r+")"+"\n"}else{i+=n+"("+a+")\n"}return i}function print_r(e){alert(json2str(e))}function isset(e){return typeof e!="undefined"}function strip_tags(e){e=e.replace(/<!--.*\-->/gi,"");e=e.replace(/<script.*\/script>/gi,"");e=e.replace(/<style.*\/style>/gi,"");return e.replace(/<[^>]+>/g,"")}function is_array(e){return toString.apply(e)==="[object Array]"}function hide(e){document.getElementById(e).style.display="none"}function display(e){document.getElementById(e).style.display="block"}function show(e){document.getElementById(e).style.display="block"}function get_html(e){return document.getElementById(e).innerHTML}function get_value(e){var t=document.getElementById(e);return t.value.trim()}function get_int_value(e,t){var i=document.getElementById(e);var r=parseInt(i.value);if(isNaN(r)){i.value=t;r=t}return r}function get_text_value(e){var t=document.getElementById(e);var i=t.value.trim();if(i==""){t.value="";t.focus();throw new Error(e+" is empty")}return i}function get_textarea_values(e){var t=get_text_value(e);var i=t.split("\n");var r=[];for(var s=0;s<i.length;++s){var a=i[s].trim();if(a==""){continue}a=encodeURIComponent(a);r.push(a)}return r}function get_radio_value(e){var t=document.getElementsByName(e);var i;for(var r=0;r<t.length;r=r+1){if(t[r].checked==true){i=t[r].value;break}}return i}function get_select_value(e){var t=document.getElementById(e);return t.options[t.selectedIndex].value}function get_checkbox_values(e){var t=[];var i=document.getElementsByName(e);for(var r=0;r<i.length;++r){if(i[r].checked){t.push(i[r].value)}}return t}function set_html(e,t){document.getElementById(e).innerHTML=t}function set_value(e,t){document.getElementById(e).value=t}function set_select_value(e,t){var i=document.getElementById(e);for(var r=0;r<i.options.length;r=r+1){if(i.options[r].value==t){i.options[r].selected=true;break}}}function set_radio_value(e,t){var i=document.getElementsByName(e);for(var r=0;r<i.length;++r){if(i[r].value==t){i[r].checked=true;return}}}function set_checkbox_checked(e,t){var i=document.getElementsByName(e);for(var r=0;r<i.length;++r){i[r].checked=t}}function set_checkbox_values(e,t){var i=document.getElementsByName(e);for(var r=0;r<i.length;++r){var s=false;for(var a=0;a<t.length;++a){if(t[a]==i[r].value){s=true;break}}i[r].checked=s}}Array.prototype.remove=function(e){if(isNaN(e)||e>this.length){return false}for(var t=0,i=0;t<this.length;t++){if(this[t]!=this[e]){this[i++]=this[t]}}this.length-=1};String.prototype.startWith=function(str,ignoreCase){var reg=eval("/^"+str+"/");if(ignoreCase)reg=eval("/^"+str+"/i");return reg.test(this)};String.prototype.startwith=function(str,ignoreCase){var reg=eval("/^"+str+"/");if(ignoreCase)reg=eval("/^"+str+"/i");return reg.test(this)};String.prototype.endWith=function(str,ignoreCase){var reg=eval("/"+str+"$/");if(ignoreCase)reg=eval("/"+str+"$/i");return reg.test(this)};String.prototype.endwith=function(str,ignoreCase){var reg=eval("/"+str+"$/");if(ignoreCase)reg=eval("/"+str+"$/i");return reg.test(this)};String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"gm"),t)};Date.prototype.format=function(e){var t=this.getFullYear();var i=this.getMonth()+1;if(i<10)i="0"+i;var r=this.getDate();if(r<10)r="0"+r;var s=this.getHours();if(s<10)s="0"+s;var a=this.getMinutes();if(a<10)a="0"+a;var n=this.getSeconds();if(n<10)n="0"+n;return e.replace(/Y/g,t).replace(/m/g,i).replace(/d/g,r).replace(/H/g,s).replace(/i/g,a).replace(/s/g,n)};function is_number(e){var t=/^[0-9]+$/;return t.test(e)}function is_decimal(e){var t=/^[0-9]+[\.]{0,1}[0-9]*$/;return t.test(e)}function is_phone(e){var t=/^1[0-9]{10}$/;return t.test(e)}function is_email(e){var t=/^[\w\-_\.]+@[\w\-_\.]+\.\w+$/;return t.test(e)}function is_url(e){var t="^((https|http|ftp|rtsp|mms)?://)"+"(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?"+"(([0-9]{1,3}.){3}[0-9]{1,3}"+"|"+"([0-9a-z_!~*'()-]+.)*"+"([0-9a-z][0-9a-z-]{0,61})?[0-9a-z]."+"[a-z]{2,6})"+"(:[0-9]{1,4})?"+"((/?)|"+"(/[0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$";var i=new RegExp(t,"i");return i.test(e)}function hasClass(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function addClass(e,t){if(!this.hasClass(e,t))e.className+=" "+t}function removeClass(e,t){if(hasClass(e,t)){var i=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(i,"")}}var MWT=mwt={};mwt.$=function(e){return document.getElementById(e)};mwt.destroy=function(e){var t=mwt.$(e);if(t)t.remove()};mwt.gen_domid=function(e){function t(e){var t="0123456789qwertyuioplkjhgfdsazxcvbnmABCDEFGHIJKLMNOPQRSTUVWXYZ";var i="";var r=(new Date).getTime();for(var s=0;s<e;s++){i+=t.charAt(Math.ceil(Math.random()*1e8)%t.length)}return i}var i=6;while(true){var r=e?e+t(i):t(i);if(!MWT.$(r)){return r}}};mwt.create_div=function(e){var t=document.getElementById(e);if(!t){var i=document.createElement("div");i.id=e;document.body.appendChild(i)}return e};MWT.extends=function(e,t){e.prototype=new t};MWT.Event=function(){this.listeners={};this.addListener=function(e,t){if(!this.listeners[e]){this.listeners[e]=[]}for(var i=0;i<this.listeners[e].length;++i){if(t==this.listeners[e][i])return}this.listeners[e].push(t)};this.on=function(e,t){this.addListener(e,t)};this.fireon=function(e,t){this.addListener(e,t);t.call(t,this)};this.removeListener=function(e,t){if(!this.listeners[e]){return}var i=this.listeners[e];for(var r=0;r<i.length;++r){if(i[r]==t){i.remove(r);return}}};this.un=function(e,t){this.removeListener(e,t)};this.removeAllListeners=function(e){delete this.listeners[e]};this.unall=function(e){this.removeAllListeners(e)};this.fireEvent=function(e){if(!this.listeners[e]){return}var t=this.listeners[e];for(var i=0;i<t.length;++i){var r=t[i];r.call(r,this)}};this.fire=function(e){this.fireEvent(e)}};MWT.Popover=function(e){this.listeners={};var t;var i="";var r="";var s;var a=0;if(e){if(e.anchor)t=e.anchor;if(e.html)i=e.html;if(e.cls)r=e.cls}function n(){s=MWT.gen_domid(t+"-");MWT.create_div(s);var e=MWT.$(s);e.className="mwt-popover top "+r;e.innerHTML='<div class="arrow"></div>'+'<div class="content">'+i+"</div>"}this.setHtml=function(e){jQuery("#"+s+" .content").html(e)};this.toggle=function(){if(a==0)this.pop();else this.hide()};this.pop=function(){if(!s)n();var e=jQuery("#"+s);e.show();l();a^=1};this.hide=function(){jQuery("#"+s).fadeOut("fast");a^=1};function l(){var e=jQuery("#"+t);var i=e.offset();var r=i.top;var a=i.left;var n=e.outerWidth();var l=e.outerHeight();var o=jQuery("#"+s);var d=o.outerWidth();var h=o.outerHeight()+11;var u=r-h;var c=a+.5*(n-d);o.css({top:u,left:c})}};MWT.extends(MWT.Popover,MWT.Event);MWT.Store=function(e){this.listeners={};this.url="";this.baseParams={};this.totalProperty=0;this.root=[];this.annex={};this.loadres;var t,i;if(e){if(e.url)this.url=e.url;if(e.beforeLoad)t=e.beforeLoad;if(e.afterLoad)i=e.afterLoad}this.size=function(){return this.root.length};this.get=function(e){return this.root[e]};this.indexOf=function(e,t){var i=this.root.length;if(typeof t=="undefined"){for(var r=0;r<i;++r)if(this.root[r]==e)return r}else{for(var r=0;r<i;++r)if(this.root[r][e]==t)return r}return-1};this.push=function(e){this.root.push(e);this.fire("load")};this.insert=function(e,t){this.root.splice(e,0,t);this.fire("load")};this.remove=function(e){this.root.splice(e,1);this.fire("load")};this.pop=function(e){this.root.pop();this.fire("load")};this.clear=function(){this.root=[];this.fire("load")};this.swap=function(e,t){var i=this.root.length;if(e>=i||e<0||t>=i||t<0||e==t)return;var r=this.root[e];this.root[e]=this.root[t];this.root[t]=r;this.fire("load")};this.set=function(e,t){this.root[e]=t;this.fire("load")};this.load=function(e){if(e){this.root=e;this.totalProperty=e.length;this.fire("load")}else{var r=this;if(t)t();jQuery.ajax({type:"post",async:true,url:this.url,data:this.baseParams,dataType:"json",complete:function(){if(i)i()},success:function(e){r.loadres=e;if(isset(e["data"])){var t=e["data"];if(isset(t.totalProperty))r.totalProperty=t.totalProperty;if(isset(t.root))r.root=t.root;if(isset(t.annex))r.annex=t.annex}r.fire("load")},error:function(e,t,i){var s="Error("+e.readyState+") : "+t;r.loadres={errmsg:s};console.log(s)}})}};this.sort=function(e,t){this.baseParams["sort"]=e;this.baseParams["dir"]=t;this.load()}};MWT.extends(MWT.Store,MWT.Event);MWT.Pagebar=function(e){this.listeners={};this.store={};this.render=null;this.pageNumCount=10;this.pageSizeList=[10,20,50,100];this.start=0;this.pageSize=10;this.pageNum=0;this.pageCount=0;this.totalProperty=0;var t=false;if(e){if(e.render)this.render=e.render;if(e.pageSize)this.pageSize=e.pageSize;if(e.pageSizeList)this.pageSizeList=e.pageSizeList;if(e.store){this.store=e.store;var i=this;this.store.on("load",function(e){i.totalProperty=e.totalProperty;i.pageNum=i.start/i.pageSize+1;i.pageCount=Math.ceil(e.totalProperty/i.pageSize);i.fire("load");i.display()})}if(e.simple)t=true}this.changePage=function(e){var t=e>0?e-1:0;this.start=t*this.pageSize;this.store.baseParams["start"]=this.start;this.store.baseParams["limit"]=this.pageSize;this.store.load()};this.changePagesize=function(e){this.pageSize=e;this.changePage(1)};this.nextPage=function(){var e=this.pageNum+1;if(e>this.pageCount){e=this.pageNum}this.changePage(e)};this.prevPage=function(){var e=this.pageNum-1;if(e<1){e=1}this.changePage(e)};this.firstPage=function(){this.changePage(1)};this.lastPage=function(){this.changePage(this.pageCount)};this.display=function(){if(this.render){var e=this;var i=this.render+"-sel";var r=this.render+"-page";if(t){var s=this.render+"-cbtn";var a='class="mwt-btn mwt-btn-default mwt-btn-xs radius" style="color:#444;margin-left:5px;width:26px;padding:0;font-size:16px;"';var n='<table class="tablay" style="margin-top:3px;"><tr><td align="center">';n+='<button name="'+s+'" data-v="'+1+'" '+a+'><i class="fa fa-angle-double-left"></i></button>';n+='<button name="'+s+'" data-v="'+(this.pageNum-1)+'" '+a+'><i class="fa fa-angle-left"></i></button>';n+='<span style="font-size:13px;margin:0 7px;color:#444;">'+this.pageNum+" / "+this.pageCount+"</span>";n+='<button name="'+s+'" data-v="'+(this.pageNum+1)+'" '+a+'><i class="fa fa-angle-right"></i></button>';n+='<button name="'+s+'" data-v="'+this.pageCount+'" '+a+'><i class="fa fa-angle-double-right"></i></button>';document.getElementById(this.render).innerHTML=n;jQuery("[name="+s+"]").click(function(){var t=jQuery(this).data("v");if(t!=e.pageNum&&t>0&&t<=e.pageCount){e.changePage(t)}});return}var n="<table class='tablay' style='margin-top:3px;'><tr><td>";var l=[{text:"首页",value:1,active:this.pageNum!=1},{text:"上一页",value:this.pageNum-1,active:this.pageNum!=1}];var o=[];var d=Math.ceil(this.pageNumCount/2);var h=this.pageNum-d;if(h<1)h=1;var u=0;while(u<this.pageNumCount){var c=h!=this.pageNum;var f={text:h,value:h,active:c};o.push(f);++h;if(h>this.pageCount)break;++u}var v=[{text:"下一页",value:this.pageNum+1,active:this.pageCount>0&this.pageNum!=this.pageCount},{text:"尾页",value:this.pageCount,active:this.pageCount>0&this.pageNum!=this.pageCount}];var m=l.concat(o,v);for(var p=0;p<m.length;++p){var g=m[p].text;var y=m[p].value;var b=m[p].active?"":"disabled";var w=p==0?0:1;n+="<button name='"+r+"' "+b+" value='"+y+"' "+"class='mwt-btn mwt-btn-default mwt-btn-xs' style='border-radius:0;margin-left:"+w+"px;'>"+g+"</button>"}n+="</td><td style='text-align:right;font-size:12px;color:#777;'>"+"共 <b>"+this.totalProperty+"</b> 条记录，每页显示个数：<select id='"+i+"'>";for(var p=0;p<this.pageSizeList.length;++p){var y=this.pageSizeList[p];var b=y==this.pageSize?"selected":"";n+="<option value='"+y+"' "+b+">"+y+"</option>"}n+="</select>";n+="</td></tr></table>";document.getElementById(this.render).innerHTML=n;document.getElementById(i).onchange=function(t){e.changePagesize(this.value)};var x=document.getElementsByName(r);for(var p=0;p<x.length;++p){x[p].onclick=function(t){e.changePage(this.value)}}}}};MWT.extends(MWT.Pagebar,MWT.Event);MWT.Field=function(e){this.listeners={};this.render=null;this.id="";this.value="";this.defaultValue="";this.cls="";this.style="";this.construct=function(e){if(e){if(isset(e.render))this.render=e.render;if(isset(e.id))this.id=e.id;if(isset(e.value))this.value=e.value;if(isset(e.style))this.style=e.style;if(isset(e.cls))this.cls=e.cls;this.defaultValue=this.value}};this.getId=function(){return this.id};this.getValue=function(){if(!this.validate()){throw new Error("validate fail");return""}else{return this.value}};this.reset=function(){this.value=this.defaultValue;this.setValue(this.defaultValue)};this.validate=function(){return true}};MWT.extends(MWT.Field,MWT.Event);MWT.CarNumberField=function(e){this.listeners={};var t="京沪苏浙粤川津渝鄂赣冀蒙鲁辽吉皖湘黑琼贵桂云藏陕甘宁青豫闽新晋";var i="ABCDEFGHIJKLMNOPQRSTUVWXYZ";var r,s,a;var n=this;var l;if(e){this.construct(e);r=this.render+"fsel";s=this.render+"ssel";a=this.render+"txt"}function o(){var e='<select id="'+r+'" class="form-control" '+'style="display:inline-block;width:auto;height:28px;">';for(var i=0;i<t.length;++i){var s=t.charAt(i);e+='<option value="'+s+'">'+s+"</option>"}e+="</select>";return e}function d(){var e='<select id="'+s+'" class="form-control" '+'style="display:inline-block;width:auto;height:28px;margin:0 5px;">';for(var t=0;t<i.length;++t){var r=i.charAt(t);e+='<option value="'+r+'">'+r+"</option>"}e+="</select>";return e}this.create=function(){var e=o()+d()+'<input type="text" id="'+a+'" value="" class="form-control" placeholder="车牌号码后5位"'+' style="display:inline-block;width:auto;padding:0 5px;width:100px;">';jQuery("#"+this.render).html(e);l=new MWT.Popover({anchor:a,html:"请输入车牌号码后5位",cls:"mwt-popover-danger"});this.setValue(this.value);jQuery("#"+r).change(h);jQuery("#"+s).change(h);jQuery("#"+a).change(h)};function h(){l.hide();n.value=get_select_value(r)+get_select_value(s)+get_value(a);n.fire("change")}this.setValue=function(e){if(e==""){this.value=e;set_value(a,"")}if(e.length!=7)return;var t=e.charAt(0);var i=e.charAt(1);var n=e.substring(2);set_select_value(r,t);set_select_value(s,i);set_value(a,n);this.value=e};this.validate=function(){l.hide();var e=get_value(a);var t=/^[A-Za-z0-9]{5}$/;if(!t.test(e)){l.pop();jQuery("#"+a).focus();setTimeout(l.hide,2e3);return false}return true}};MWT.extends(MWT.CarNumberField,MWT.Field);MWT.CheckboxField=function(e){this.listeners={};var t=[];var i;var r;var s=false;var a;var n;if(e){if(isset(e.options))t=e.options;this.construct(e);if(this.id=="")this.id=this.render+"sel";if(this.value=="")this.value=[];if(this.defaultValue=="")this.defaultValue=[];if(e.errmsg)r=e.errmsg;if(e.checkfun)a=e.checkfun;if(e.empty)s=e.empty}this.create=function(){var e=this;var s=this.id;n=this.render+"cbx";var a=[];for(var l=0;l<t.length;++l){var o=t[l];var d='<label class="'+this.cls+'" style="cursor:pointer;display:inline-block;">'+'<input type="checkbox" name="'+n+'" value="'+o.value+'"><i></i><span>'+o.text+"</span></label>";a.push(d)}var h=a.join("&nbsp;&nbsp;");jQuery("#"+this.render).html(h);i=new MWT.Popover({anchor:e.render,html:r,cls:"mwt-popover-danger"});jQuery("[name="+n+"]").change(function(){e.value=get_checkbox_values(n);e.fire("change")});this.reset()};this.setValue=function(e){this.value=e;set_checkbox_values(n,e)};this.validate=function(){i.hide();var e=this.value;if(!s&&e.length==0||a&&!a(this.value)){i.pop();setTimeout(i.hide,2e3);return false}return true}};MWT.extends(MWT.CheckboxField,MWT.Field);MWT.ComboxField=function(e){this.listeners={};var t;var i;var r=false;var s;var a,n,l;var o="";var d="请选择...";if(e){this.construct(e);if(e.errmsg)i=e.errmsg;if(e.checkfun)s=e.checkfun;if(e.empty)r=e.empty;if(e.popStyle)o=e.popStyle;if(e.text)d=e.text;a=this.render+"-btn";n=this.render+"-btn-txt";l=this.render+"-opt"}this.create=function(){var e=this;var r='<div class="mwt-field">'+'<a id="'+a+'" class="mwt-btn mwt-btn-default '+this.cls+'" href="javascript:;" style="'+this.style+'">'+'<span id="'+n+'">'+d+'</span><i class="fa fa-caret-down"></i></a>'+'<div id="'+l+'" class="mwt-field-pop" style="'+o+'">'+"</div>"+"</div>";jQuery("#"+this.render).html(r);t=new MWT.Popover({anchor:a,html:i,cls:"mwt-popover-danger"});this.setValue(this.value);jQuery("#"+a).click(function(t){jQuery("#"+l).show();e.fire("pop");jQuery(document).on("click",function(){jQuery("#"+l).hide()});t.stopPropagation()});jQuery("#"+l).click(function(e){e.stopPropagation()});this.fire("create")};this.getPopDivId=function(){return l};this.setValue=function(e){this.value=e};this.setText=function(e){jQuery("#"+n).html(e);jQuery("#"+l).hide()};this.validate=function(){t.hide();var e=this.value;if(!r&&e==""||s&&!s(this.value)){t.pop();setTimeout(t.hide,2e3);return false}return true}};MWT.extends(MWT.ComboxField,MWT.Field);Date.prototype.format=function(e){var t={"m+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"M+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(e))e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(2-RegExp.$1.length));for(var i in t)if(new RegExp("("+i+")").test(e))e=e.replace(RegExp.$1,RegExp.$1.length==1?t[i]:("00"+t[i]).substr((""+t[i]).length));return e};MWT.DatePicker=function(e){this.listeners={};this.format="yy/mm/dd";if(e){this.construct(e);if(this.id=="")this.id=this.render+"txt";if(isset(e.format))this.format=e.format;if(!isset(e.value))this.value=(new Date).format(this.format)}this.create=function(){var e=this;var t=this.id;var i="<input type='text' class='form-control form-datepicker'";if(this.style!="")i+=' style="'+this.style+'"';i+=" id='"+t+"' value='"+this.value+"' readonly/>";jQuery("#"+this.render).html(i);jQuery("#"+t).datepicker({changeMonth:true,numberOfMonths:1,dateFormat:this.format});jQuery("#"+t).change(function(){e.value=jQuery(this).val();e.fire("change")})};this.setValue=function(e){this.value=e;set_value(this.id,e)}};MWT.extends(MWT.DatePicker,MWT.Field);MWT.DateRangePicker=function(e){this.listeners={};this.format="yy/mm/dd";this.float="left";if(e){this.construct(e);if(isset(e.format))this.format=e.format;if(isset(e.float))this.float=e.float;if(this.id=="")this.id=this.render+"txt"}this.create=function(){var e=this;var t=this.id;var i=this.id+"rdiv";var r=this.id+"from";var s=this.id+"to";var a=' style="width:180px" ';if(this.style!="")a=' style="'+this.style+'" ';var n="<div class='date-range'><input type='text' class='form-control form-datepicker'"+a+"id='"+t+"' value='"+this.value+"' readonly/>"+"<div class='date-pop' id='"+i+"' style='"+this.float+":0;'>"+"<div class='btn-bar'>"+'<button class="date-submit mwt-btn mwt-btn-default mwt-btn-sm radius" data-value="90">最近90天</button>'+'<button class="date-submit mwt-btn mwt-btn-default mwt-btn-sm radius" data-value="60">最近60天</button>'+'<button class="date-submit mwt-btn mwt-btn-default mwt-btn-sm radius" data-value="30">最近30天</button>'+'<button class="date-submit mwt-btn mwt-btn-default mwt-btn-sm radius" data-value="7">最近7天</button>'+'<button class="date-submit mwt-btn mwt-btn-default mwt-btn-sm radius" data-value="0">今天</button>'+'<button class="date-submit mwt-btn mwt-btn-danger mwt-btn-sm radius fr" data-value="cancel">取消</button>'+'<button class="date-submit mwt-btn mwt-btn-primary mwt-btn-sm radius fr">确定</button>'+"</div>"+'<div class="date-area" id="'+r+'" style="display:inline-block;"></div>'+'<div class="date-area" id="'+s+'" style="float:right;"></div>'+"</div></div>";jQuery("#"+this.render).html(n);var l=jQuery("#"+t);l.click(function(){jQuery("#"+i).show("fast")});var o=jQuery("#"+r);var d=jQuery("#"+s);o.datepicker({defaultDate:"+1w",changeMonth:true,numberOfMonths:1,onSelect:function(e){d.datepicker("option","minDate",e)}});d.datepicker({defaultDate:"+1w",changeMonth:true,numberOfMonths:1,onSelect:function(e){o.datepicker("option","maxDate",e)}});var h=jQuery("#"+i);h.find(".date-submit").click(function(){var t=jQuery(this);var r=t.data("value");if(r=="cancel"){jQuery("#"+i).hide("fast");return}var s=new Date;var a=new Date;s.setTime(s.getTime()-864e5*r);if(r>0){a.setTime(a.getTime()-864e5)}else{a.setTime(a.getTime())}o.datepicker("setDate",s);d.datepicker("setDate",a);var n=o.datepicker("getDate").format(e.format);var h=d.datepicker("getDate").format(e.format);e.value=n+" ~ "+h;l.val(e.value);jQuery("#"+i).hide("fast");e.fire("change")});this.setDefault(7)};this.setDefault=function(e){var t=this;var i=this.id+"from";var r=this.id+"to";var s=this.id;var a=jQuery("#"+i);var n=jQuery("#"+r);var l=jQuery("#"+s);var o=new Date;var d=new Date;o.setTime(o.getTime()-864e5*e);d.setTime(d.getTime()-864e5);a.datepicker("setDate",o);n.datepicker("setDate",d);var h=a.datepicker("getDate").format(t.format);var u=n.datepicker("getDate").format(t.format);t.value=h+" ~ "+u;l.val(t.value)}};MWT.extends(MWT.DateRangePicker,MWT.Field);MWT.DateTimePicker=function(e){this.listeners={};this.format="yy/mm/dd";if(e){this.construct(e);if(this.id=="")this.id=this.render+"txt";if(isset(e.format))this.format=e.format;if(!isset(e.value))this.value=(new Date).format(this.format)}this.create=function(){var e=this;var t=this.id;var i="<input type='text' class='form-control form-datepicker'";if(this.style!="")i+=' style="'+this.style+'"';i+=" id='"+t+"' value='"+this.value+"' readonly/>";jQuery("#"+this.render).html(i);jQuery("#"+t).datetimepicker({changeMonth:true,numberOfMonths:1,dateFormat:this.format});jQuery("#"+t).change(function(){e.value=jQuery(this).val();e.fire("change")})};this.setValue=function(e){this.value=e;set_value(this.id,e)}};MWT.extends(MWT.DateTimePicker,MWT.Field);MWT.RadiobtnField=function(e){this.listeners={};this.options=[];if(e){if(isset(e.options))this.options=e.options;this.construct(e);if(this.id=="")this.id=this.render+"sel";if(e.style)this.style=e.style;if(e.class)this.class=e.class}this.create=function(){var e=this;var t=this.id+"rabtn";var i="<div class='mwt-btn-group' style='"+this.style+"'>";for(var r=0;r<this.options.length;++r){var s=isset(this.value)?this.value:0;var a=this.options[r].value==s?"active":"";var n="mwt-btn mwt-btn-xs";if(isset(this.class))n+=" "+this.class;else n+=" mwt-btn-primary";n+=" "+a;i+="<button name='"+t+"' class='"+n+"' data-value='"+this.options[r].value+"'>"+this.options[r].text+"</button>"}i+="</div><input type='hidden' id='"+this.id+"' value='"+this.value+"'/>";jQuery("#"+this.render).html(i);jQuery("button[name="+t+"]").click(function(){jQuery("button[name="+t+"]").removeClass("active");jQuery(this).addClass("active");e.value=jQuery(this).data("value");set_value(e.id,e.value);e.fire("change")})};this.setValue=function(e){this.value=e;jQuery("#"+this.id).val(e);var t=this.id+"rabtn";jQuery("button[name="+t+"]").removeClass("active");jQuery("button[data-value='"+e+"']").addClass("active")}};MWT.extends(MWT.RadiobtnField,MWT.Field);MWT.RadioField=function(e){this.listeners={};var t=[];var i;var r;var s=false;var a;var n;if(e){if(isset(e.options))t=e.options;this.construct(e);if(e.errmsg)r=e.errmsg;if(e.checkfun)a=e.checkfun;if(e.empty)s=e.empty}this.create=function(){var e=this;var s=this.id;n=this.render+"rdo";var a=[];for(var l=0;l<t.length;++l){var o=t[l];var d='<label class="'+this.cls+'" style="cursor:pointer;">'+'<input type="radio" name="'+n+'" value="'+o.value+'"><i></i><span>'+o.text+"</span></label>";a.push(d)}var h=a.join("&nbsp;&nbsp;");jQuery("#"+this.render).html(h);i=new MWT.Popover({anchor:e.render,html:r,cls:"mwt-popover-danger"});jQuery("[name="+n+"]").change(function(){e.value=get_radio_value(n);e.fire("change")});this.reset()};this.setValue=function(e){this.value=e;set_radio_value(n,e)};this.validate=function(){i.hide();var e=this.value;if(!s&&e==""||a&&!a(this.value)){i.pop();setTimeout(i.hide,2e3);return false}return true}};MWT.extends(MWT.RadioField,MWT.Field);MWT.RatingField=function(e){this.listeners={};var t;var i="";var r="";var s={1:"",2:"",3:"",4:"",5:""};var a="";var n="";if(e){this.construct(e);if(e.starStyle)a=e.starStyle;if(e.noteStyle)n=e.noteStyle;if(e.notes)s=e.notes}this.create=function(){var e="<div class='"+this.cls+"' style='"+this.style+"'>";r=this.render+"vdiv";i=this.render+"star";for(var t=1;t<=5;t++){e+='<i name="'+i+'" id="'+i+t+'" data-id="'+t+'" class="fa fa-star-o" style="cursor:pointer;'+a+'"></i>'}e+='<span id="'+r+'" style="'+n+'"></span>';e+="</div>";jQuery("#"+this.render).html(e);var s=this;jQuery("[name="+i+"]").click(function(){var e=jQuery(this).data("id");s.setValue(e);s.fire("change")});this.reset()};this.setValue=function(e){this.value=e;for(var t=1;t<=5;++t){if(t<=e){jQuery("#"+i+t).removeClass("fa-star-o");jQuery("#"+i+t).addClass("fa-star")}else{jQuery("#"+i+t).removeClass("fa-star");jQuery("#"+i+t).addClass("fa-star-o")}}var a=s[e]?s[e]:"";jQuery("#"+r).html(a)}};MWT.extends(MWT.RatingField,MWT.Field);MWT.SelectField=function(e){this.listeners={};this.options=[];if(e){if(isset(e.options))this.options=e.options;this.construct(e);if(this.id=="")this.id=this.render+"sel"}this.create=function(){var e=this;var t=this.id;var i="<select id='"+this.id+"'";if(this.cls!=""){i+=" class='"+this.cls+"'"}else{i+=" class='form-control'"}if(this.style!="")i+=' style="'+this.style+'"';else i+=' style="width:auto;border-radius:2px;"';i+=">";for(var r=0;r<this.options.length;++r){var s=isset(this.value)?this.value:0;var a=this.options[r].value==s?"selected":"";i+="<option value='"+this.options[r].value+"' "+a+">"+this.options[r].text+"</option>"}i+="</select>";jQuery("#"+this.render).html(i);jQuery("#"+t).change(function(){var t=jQuery(this).children("option:selected").val();e.value=t;e.fire("change")})};this.setValue=function(e){this.value=e;set_select_value(this.id,e)}};MWT.extends(MWT.SelectField,MWT.Field);MWT.TextField=function(e){this.listeners={};var t=this;var i;var r="text";var s="";var a;var n;var l=false;var o;var d,h="max-height:100px;";var u;if(e){this.construct(e);if(e.type)r=e.type;if(e.placeholder)s=e.placeholder;if(e.errmsg)n=e.errmsg;if(e.checkfun)o=e.checkfun;if(e.empty)l=e.empty;i=this.render+"txt";d=this.render+"pop";if(e.popStyle)h=e.popStyle;u=this.render+"skey"}this.create=function(){var e;if(r=="textarea"){e='<textarea id="'+i+'" class="form-control '+this.cls+'" placeholder="'+s+'"'+' style="'+this.style+'"></textarea>'}else{e='<div style="position:relative">'+'<input type="'+r+'" id="'+i+'" class="form-control '+this.cls+'" placeholder="'+s+'"'+' style="'+this.style+';padding-right:20px;">'+'<i id="'+i+'-clear" class="fa fa-times-circle" style="display:none;color:#999;font-size:14px;margin-left:-20px;"></i>'+'<div id="'+d+'" class="mwt-field-pop" style="'+h+'">'+"</div>"}jQuery("#"+this.render).html(e);a=new MWT.Popover({anchor:i,html:n,cls:"mwt-popover-danger"});this.setValue(this.value);var t=jQuery("#"+i);var l=jQuery("#"+i+"-clear");var o=jQuery("#"+d);t.change(c);t.focus(function(){l.show();f();jQuery(document).unbind("click").on("click",function(){var e=document.activeElement.id;if(e!=i){o.hide();l.hide()}});event.stopPropagation()});o.click(function(e){e.stopPropagation()});l.click(function(){t.val("").focus()})};function c(){a.hide();t.value=get_value(i);t.fire("change");if(t.value!="")jQuery("#"+i+"-clear").show()}this.setValue=function(e){set_value(i,e);this.value=e};this.validate=function(){a.hide();var e=l?get_value(i):get_text_value(i);if(o&&!o(e)){a.pop();jQuery("#"+i).focus();setTimeout(a.hide,2e3);return false}return true};this.readOnly=function(e){if(e)jQuery("#"+i).attr("readonly",true);else jQuery("#"+i).removeAttr("readonly")};function f(){var e=localStorage.getItem(u);if(!e)return;var r=e.split("||");if(r.length==0)return;var s='<div class="mwt-pop-words"><a id="'+this.render+'-pop-clrbtn" href="javascript:;">清空</a>'+'<ul id="'+this.render+'-wdul">';for(var a=0;a<r.length;++a){s+='<li name="'+t.render+'-wd">'+r[a]+"</li>"}s+="</ul></div>";jQuery("#"+d).show().html(s);jQuery("[name="+t.render+"-wd]").click(function(){var e=jQuery(this).html();jQuery("#"+i).val(e);c()});jQuery("#"+this.render+"-pop-clrbtn").click(function(){t.clearwords();jQuery("#"+this.render+"-wdul").html("")})}this.addword=function(e){var t=localStorage.getItem(u);var i=t?t.split("||"):[];if(!in_array(e,i)){i.push(e);localStorage.setItem(u,i.join("||"))}};this.clearwords=function(){localStorage.removeItem(u)}};MWT.extends(MWT.TextField,MWT.Field);MWT.ImageUploadField=function(e){this.listeners={};var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAAAsCAIAAACi3dJfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABqSURBVGhD7c+xDYAwEARB+q/KnRkQLmH0AdqJLjvttWettc6aUqFWoVehVqFXoVahV6FWoVehVqFXoVahV6FWofcWPq9/dQonfa+TKtQq9CrUKvQq1Cr0KtQq9CrUKvQq1Cr0KtSmC/e+AURnMevdfLBSAAAAAElFTkSuQmCC";var i,r,s;var a="";var n;var l;var o=false;var d=this;if(e){this.cls="upimg";this.construct(e);if(this.id=="")this.id=this.render+"img";if(e.emptyImg)t=e.emptyImg;if(e.imgupapi)a=e.imgupapi;if(e.empty)o=e.empty;if(e.errmsg)l=e.errmsg}this.create=function(){var e=this;var r=this.render+"img";s=this.render+"file";var a=this.value==""?t:this.value;var o='<img id="'+r+'" src="'+a+'" class="'+this.cls+'" style="'+this.style+'" onclick="jQuery(\'#'+s+"').click();\">"+'<div id="'+s+'form"></div>';jQuery("#"+this.render).html(o);i=jQuery("#"+r);h();n=new MWT.Popover({anchor:r,html:l,cls:"mwt-popover-danger"})};function h(){var e='<form method="POST" enctype="multipart/form-data">'+'<input type="file" id="'+s+'" name="upfile" accept="image/*" style="display:none;"/>'+"</form>";jQuery("#"+s+"form").html(e);r=jQuery("#"+s);r.change(u)}function u(){var e=r.val();jQuery.ajaxFileUpload({url:a,secureuri:false,fileElementId:s,dataType:"json",timeout:3e4,complete:function(e){h()},success:function(e,t){if(e.retcode!=0){MWT.alert(e.retmsg)}else{d.setValue(e.data.imgurl)}},error:function(e,t,i){MWT.alert(i)}})}this.setValue=function(e){this.value=e;if(e!=""){i.attr("src",e)}else{i.attr("src",t)}};this.validate=function(){n.hide();if(!o&&this.value==""){n.pop();setTimeout(n.hide,2e3);return false}return true}};MWT.extends(MWT.ImageUploadField,MWT.Field);MWT.MultiImageUploadField=function(e){this.listeners={};var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEsAAAAsCAIAAACi3dJfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAABqSURBVGhD7c+xDYAwEARB+q/KnRkQLmH0AdqJLjvttWettc6aUqFWoVehVqFXoVahV6FWoVehVqFXoVahV6FWofcWPq9/dQonfa+TKtQq9CrUKvQq1Cr0KtQq9CrUKvQq1Cr0KtSmC/e+AURnMevdfLBSAAAAAElFTkSuQmCC";var i,r,s;var a="";var n;var l;var o=false;var d=this;if(e){this.cls="upimg";this.construct(e);if(this.id=="")this.id=this.render+"img";if(e.emptyImg)t=e.emptyImg;if(e.imgupapi)a=e.imgupapi;if(e.empty)o=e.empty;if(e.errmsg)l=e.errmsg;this.value=[]}this.create=function(){var e=this;var r=this.render+"img";s=this.render+"file";var a=t;var o='<ul id="'+this.render+'-imgs" class="mwt-imgup-ul"></ul>'+'<img id="'+r+'" src="'+a+'" class="'+this.cls+'" style="'+this.style+'" onclick="jQuery(\'#'+s+"').click();\">"+'<div id="'+s+'form"></div>';
jQuery("#"+this.render).html(o);i=jQuery("#"+r);h();n=new MWT.Popover({anchor:r,html:l,cls:"mwt-popover-danger"})};function h(){var e='<form method="POST" enctype="multipart/form-data">'+'<input type="file" id="'+s+'" name="upfile" accept="image/*" style="display:none;"/>'+"</form>";jQuery("#"+s+"form").html(e);r=jQuery("#"+s);r.change(u)}function u(){var e=r.val();jQuery.ajaxFileUpload({url:a,secureuri:false,fileElementId:s,dataType:"json",timeout:3e4,complete:function(e){h()},success:function(e,t){if(e.retcode!=0){MWT.alert(e.retmsg)}else{d.setValue(e.data.imgurl)}},error:function(e,t,i){MWT.alert(i)}})}function c(){var e=jQuery("#"+d.render+"-imgs");e.html("");if(d.value.length==0)return;for(var t=0;t<d.value.length;++t){var i=d.value[t];var r="<li>"+'<img src="'+i+'" style="'+d.style+'">'+'<i name="'+d.render+'-upimg-del" data-idx="'+t+'" class="fa fa-minus-circle"></i>'+"</li>";e.append(r)}jQuery("[name="+d.render+"-upimg-del]").unbind("click").click(function(){var e=jQuery(this).data("idx");d.value.remove(e);c()})}this.setValue=function(e){if(e=="")return;if(!is_array(this.value))this.value=[];this.value.push(e);c()};this.validate=function(){n.hide();if(!o&&this.value.length==0){n.pop();setTimeout(n.hide,2e3);return false}return true}};MWT.extends(MWT.MultiImageUploadField,MWT.Field);MWT.Widget=function(e){this.listeners={};this.render=null;this.cls="";this.style="";this.created=false;this.construct=function(e){if(e){if(e.render)this.render=e.render;if(e.style)this.style=e.style;if(e.cls)this.cls=e.cls}};this.create=function(){};this.show=function(){this.fire("beforeShow");if(!this.created)this.create();jQuery("#"+this.render).show();this.fire("show");return this};this.hide=function(){this.fire("beforeHide");jQuery("#"+this.render).hide();this.fire("hide");return this}};MWT.extends(MWT.Widget,MWT.Event);MWT.CalendarWidget=function(e){this.listeners={};var t=50;var i="";var r,s,a,n,l,o;var d,h,u,c;if(e){this.construct(e);if(e.cellHeight)t=e.cellHeight;if(e.cellStyle)i=e.cellStyle;r=this.render+"-cal";s=this.render+"-tt";a=this.render+"-lb";n=this.render+"-rb";l=this.render+"-nb";o=this.render+"-cell";d=this}this.create=function(){var e=["日","一","二","三","四","五","六"];var t="mwt-btn mwt-btn-default mwt-btn-xs";var i="width:40px;height:30px;";var o='<button id="'+a+'" class="'+t+'" '+'style="border-top-left-radius:30px;border-bottom-left-radius:30px;'+i+'">'+'<i class="fa fa-angle-left" style="font-size:20px;"></i></button>';var h='<button id="'+n+'" class="'+t+'" '+'style="border-top-right-radius:30px;border-bottom-right-radius:30px;'+i+'">'+'<i class="fa fa-angle-right" style="font-size:20px;"></i></button>';var v='<button id="'+l+'" class="'+t+'" style="height:30px;font-size:15px;width:50px;">本月</button>';var m='<div class="mwt-calendar">'+'<div class="mwt-btn-group">'+o+v+h+"</div>"+'<div id="'+s+'" class="title"></div>'+"</div>"+'<table class="mwt-calendar-table"><thead><tr>';for(var p=0;p<e.length;++p)m+="<td>"+e[p]+"</td>";m+='</tr></thead><tbody id="'+r+'"></tbody></table>';jQuery("#"+this.render).html(m);jQuery("#"+a).click(function(){d.prev()});jQuery("#"+n).click(function(){d.next()});jQuery("#"+l).click(function(){u=date("Y-m");f()});c=date("Y-m-d");u=date("Y-m");f()};this.getCell=function(e){return jQuery("#"+o+"-"+e).html()};this.setCell=function(e,t){jQuery("#"+o+"-"+e).html(t)};this.appendCell=function(e,t){jQuery("#"+o+"-"+e).append(t)};this.getDateList=function(){return h};this.next=function(){var e=strtotime(u+"-01");e+=32*86400;u=date("Y-m",e);f()};this.prev=function(){var e=strtotime(u+"-01");e-=86400;u=date("Y-m",e);f()};function f(){h=v(u);var e=strtotime(u);var a=date("Y年m月",e);var n=date("m",e);jQuery("#"+s).html(a);var l="";for(var f=0;f<h.length;++f){var m="";var p=h[f];if(p.week==0)l+="<tr>";if(p.date==c)m+=" today";if(p.month!=n)m+=" misday";l+='<td class="'+m+'" style="height:'+t+'px">'+'<div id="'+o+"-"+p.date+'" style="'+i+'" class="cell-body"></div>'+'<div class="cell-date">'+p.day+"</div></td>";if(p.week==6)l+="</tr>"}jQuery("#"+r).html(l);d.fire("refresh")}function v(e){var t=[];var i=e+"-01";var r=new Date(i);var s=r.getDay();var a=strtotime(i);var n=a-(s+1)*86400;var l=date("m",a);for(var o=0;o<6;++o){for(k=0;k<7;++k){n+=86400;t.push({week:k,day:date("d",n),month:date("m",n),date:date("Y-m-d",n)})}if(date("m",n)!=l)break}return t}};MWT.extends(MWT.CalendarWidget,MWT.Widget);MWT.TabPanel=function(e){this.listeners={};this.title;this.body;if(e){if(e.title)this.title=e.title;if(e.body)this.body=e.body}};MWT.extends(MWT.TabPanel,MWT.Event);MWT.TabWidget=function(e){this.listeners={};var t=this;var i=false;var r=false;var s="";var a=[];var n=-1;if(e){this.construct(e);if(e.panels)a=e.panels;if(e.justify)i=true;if(e.border)r=true;if(e.headerStyle)s=e.headerStyle}this.create=function(){var e=i?"mwt-nav-justify":"";var n=r?"bordered":"";var l='<div class="mwt-tabpanel '+n+'" style="'+this.style+'">'+'<div class="mwt-tabhead" style="'+s+'">'+'<ul class="mwt-nav mwt-nav-tabs '+e+'">';var o="";var d=this.render+"-nm";for(var h=0;h<a.length;++h){var u=a[h];var c=this.render+"-tab-head-"+h;var f=h==0?'style="padding-left:5px;"':"";l+='<li id="'+c+'" '+f+'><a name="'+d+'" data-idx="'+h+'" href="javascript:;">'+u.title+"</a></li>";var v=this.render+"-tab-body-"+h;o+='<div id="'+v+'" class="mwt-tabpanel-body">'+u.body+"</div>"}l+="</ul></div>"+o+"</div>";jQuery("#"+this.render).html(l);jQuery("[name="+d+"]").click(function(){var e=jQuery(this).data("idx");t.active(e)})};this.active=function(e){if(n==e)return;n=e;for(var t=0;t<a.length;++t){var i=a[t];var r=this.render+"-tab-head-"+t;var s=this.render+"-tab-body-"+t;if(e==t){jQuery("#"+r).addClass("mwt-active");jQuery("#"+s).show();i.fire("show")}else{jQuery("#"+r).removeClass("mwt-active");jQuery("#"+s).hide()}}}};MWT.extends(MWT.TabWidget,MWT.Widget);MWT.Form=function(e){this.listeners={};var t=[];var i;if(e){if(e.fields){i=e.fields;r()}}function r(){t=[];if(!i||i.length==0)return;var e;for(var r=0;r<i.length;++r){var s=i[r];switch(s.type){case"image":e=new MWT.ImageUploadField(s);break;default:e=new MWT.TextField(s);break}t.push({name:s.name,field:e})}}this.create=function(){for(var e=0;e<t.length;++e){t[e].field.create()}};this.addField=function(e,i){if(this.getFieldByName(e))return;t.push({name:e,field:i})};this.getField=function(e){return t[e].field};this.getFieldByName=function(e){for(var i=0;i<t.length;++i){if(t[i].name==e)return t[i].field}return null};this.getData=function(){var e={};for(var i=0;i<t.length;++i){var r=t[i];e[r.name]=r.field.getValue()}return e};this.reset=function(){for(var e=0;e<t.length;++e){t[e].field.reset()}};this.set=function(e){for(var i=0;i<t.length;++i){var r=t[i];var s=r.name;if(isset(e[s]))r.field.setValue(e[s])}}};MWT.extends(MWT.Form,MWT.Event);MWT.Tree=function(e){this.listeners={};this.root;this.render=null;this.showRoot=false;if(e){if(isset(e.showRoot))this.showRoot=e.showRoot;if(isset(e.render))this.render=e.render}function t(e){return!isset(e.children)}function i(e){if(t(e))return false;if(isset(e.expand)&&!e.expand)return false;return true}this.togglenode=function(){var e="sub-tree-"+jQuery(this).data("sub-tree");if(jQuery(this).hasClass("folder")){jQuery(this).removeClass("folder");jQuery(this).addClass("folder-open");jQuery("#"+e).show()}else{jQuery(this).removeClass("folder-open");jQuery(this).addClass("folder");jQuery("#"+e).hide()}};this.load=function(e){this.root=e;var t="";var i="<ul class='mwt-tree'>";if(this.showRoot){i+=this.display_tree_node(e,t)}else if(isset(e.children)){for(var r=0;r<e.children.length;++r){i+=this.display_tree_node(e.children[r],t)}}i+="</ul>";set_html(this.render,i);var s=this;jQuery(".folder").click(s.togglenode);jQuery(".folder-open").click(s.togglenode);jQuery(".tree-node").click(function(){s.click_node(jQuery(this).data("node-id"))})};this.display_tree_node=function(e,t){var r="<li>"+this.get_tree_node_prefix(t,e)+this.get_tree_node(e);if(isset(e.children)){var s="";if(!i(e))s="display:none";r+="<ul class='mwt-tree' id='sub-tree-"+e.node_id+"' style='"+s+"'>";var a=t+"<span style='padding-left:15px;'></span>";for(var n=0;n<e.children.length;++n){r+=this.display_tree_node(e.children[n],a)}r+="</ul>"}r+="</li>";return r};this.get_tree_node_prefix=function(e,r){var s="folder-open";if(t(r))s="leaf";else if(!i(r)){s="folder"}return e+"<i class='icon "+s+"' data-sub-tree='"+r.node_id+"'></i>"};this.get_tree_node=function(e){var t="<a href='javascript:void(0);' class='tree-node' id='tn-"+e.node_id+"' "+"data-node-id='"+e.node_id+"' data-node-value='"+e.node_value+"'>"+e.node_name+"</a>";return t};this.click_node=function(e){var t=jQuery("#tn-"+e);var i={node_id:e,node_name:t.html(),node_value:t.data("node-value")};this.clicked_node=i;this.fire("click-node")};this.fold=function(){this.toggle(0)};this.unfold=function(){this.toggle(1)};this.toggle=function(e){var t=this.root;for(var i=0;i<t.children.length;++i){var r=t.children[i].node_id;$subtree=jQuery("#sub-tree-"+r);$icon=jQuery("[data-sub-tree='"+r+"']");if(e==0){$icon.removeClass("folder-open");$icon.addClass("folder");$subtree.hide()}else{$icon.removeClass("folder");$icon.addClass("folder-open");$subtree.show()}}}};MWT.extends(MWT.Tree,MWT.Event);MWT.Bar=function(e){this.listeners={};this.render=null;this.style=null;this.items=[];if(e){if(e.render)this.render=e.render;if(e.items)this.items=e.items;if(e.style)this.style=e.style}this.create=function(){var e=this.style?"style='"+this.style+"'":"";var t="<div class='mwt-bar' "+e+"><table><tr>";var i=false;for(var r=0;r<this.items.length;++r){var s=this.items[r];if(s=="->"){t+="<td width='100%'></td>";i=true;continue}if(s=="-"){if(!i)t+="<td width='100%'></td>";t+="</tr></table><hr><table><tr>";i=false;continue}if(isset(s.html)){t+="<td>"+s.html+"</td>";continue}var a=isset(this.items[r].type)?this.items[r].type:"button";switch(a){case"select":case"radiobtn":t+=this.renderSelect(s,r);break;case"search":t+=this.renderSearch(s,r);break;case"datepicker":t+=this.renderDatepicker(s,r);break;case"daterangepicker":t+=this.renderDaterangepicker(s,r);break;case"text":case"password":t+=this.renderText(s,r);break;case"button":default:t+=this.renderButton(s,r);break}}if(!i)t+="<td width='100%'></td>";t+="</tr></table></div>";set_html(this.render,t);for(var r=0;r<this.items.length;++r){var a=isset(this.items[r].type)?this.items[r].type:"button";switch(a){case"select":t+=this.bundleSelect(this.items[r],r);break;case"radiobtn":t+=this.bundleRadiobtn(this.items[r],r);break;case"text":t+=this.bundleText(this.items[r],r);break;case"search":t+=this.bundleSearch(this.items[r],r);break;case"datepicker":this.bundleDatepicker(this.items[r],r);break;case"daterangepicker":this.bundleDaterangepicker(this.items[r],r);break;case"button":default:t+=this.bundleButton(this.items[r],r);break}}};this.genid=function(e,t){if(isset(e.id)&&e.id!="")return e.id;return this.render+"_item_"+t};function t(e,t){if(e.label)return"<label>"+e.label+":&nbsp;</label></td><td style='padding-left:0;'>";return""}this.renderSearch=function(e,t){var i=this.genid(e,t);var r=i+"btn";var s=isset(e.width)?e.width:200;var a=s-70;var n=isset(e.class)?e.class:"";var l=isset(e.label&&e.label!="")?e.label:"����";var o=isset(e.value)?e.value:"";var d=isset(e.placeholder)?e.placeholder:"";var h=isset(e.style)?e.style:"";var u="<td>"+'<div class="mwt-text-search '+n+'" style="'+h+'">'+'<input id="'+i+'" type="text" style="width:'+s+'px;" value="'+o+'" placeholder="'+d+'">'+'<i id="'+r+'" class="fa fa-search"></i>'+"</div>"+"</td>";return u};this.bundleSearch=function(e,t){var i=this.genid(e,t);var r=i+"btn";if(isset(e.handler)){jQuery("#"+r).click(e.handler);jQuery("#"+i).change(e.handler)}};this.renderText=function(e,i){var r=this.genid(e,i);var s=isset(e.width)?e.width:200;var a=e.placeholder?'placeholder="'+e.placeholder+'"':"";var n=e.style?e.style:"";var l=e.cls?e.cls:"form-control";var o="<td>"+t(e,i)+'<input id="'+r+'" type="'+e.type+'" '+'class="'+l+'" style="width:'+s+"px;"+n+'" '+a+"></td>";return o};this.bundleText=function(e,t){if(isset(e.handler)){jQuery("#"+this.genid(e,t)).change(e.handler)}};this.renderButton=function(e,t){var i="<td><button id='"+this.genid(e,t)+"'";if(isset(e.class))i+=' class="'+e.class+'"';else i+=' class="mwt-btn mwt-btn-primary"';if(isset(e.style))i+=' style="'+e.style+'"';i+=">"+e.label+"</button></td>";return i};this.bundleButton=function(e,t){var i=this.genid(e,t);if(isset(e.handler)){jQuery("#"+i).click(function(){e.handler()})}};this.renderSelect=function(e,i){return"<td>"+t(e,i)+"<div id='"+this.genid(e,i)+"div'></div></td>"};this.bundleSelect=function(e,t){var i=new MWT.SelectField({render:this.genid(e,t)+"div",id:this.genid(e,t),options:e.options,value:e.value,cls:e.class,style:e.style});i.create();if(isset(e.handler)){i.on("change",e.handler)}};this.renderRadiobtn=function(e,i){return"<td>"+t(e,i)+"<div id='"+this.genid(e,i)+"div'></div></td>"};this.bundleRadiobtn=function(e,t){var i=new MWT.RadiobtnField({render:this.genid(e,t)+"div",id:this.genid(e,t),options:e.options,value:e.value,"class":e.class,style:e.style});i.create();if(isset(e.handler)){i.on("change",e.handler)}};this.renderDatepicker=function(e,i){var r=e.width?e.width:100;return"<td>"+t(e,i)+"<div id='"+this.genid(e,i)+"div' style='width:"+r+"px;'></div></td>"};this.bundleDatepicker=function(e,t){var i=new MWT.DatePicker({render:this.genid(e,t)+"div",id:this.genid(e,t),format:e.format?e.format:"yy-mm-dd"});i.create();if(isset(e.handler)){i.on("change",e.handler)}};this.renderDaterangepicker=function(e,i){return"<td>"+t(e,i)+"<div id='"+this.genid(e,i)+"div'></div></td>"};this.bundleDaterangepicker=function(e,t){var i=new MWT.DateRangePicker({render:this.genid(e,t)+"div",id:this.genid(e,t),"float":e.float?e.float:"right",format:e.format?e.format:"yy/mm/dd"});i.create();if(e.value){i.setDefault(e.value)}if(isset(e.handler)){i.on("change",e.handler)}}};MWT.extends(MWT.Bar,MWT.Event);MWT.Grid=function(e){this.listeners={};this.render=null;this.grid_div=null;this.grid_chkbox_id=null;this.grid_chkbox_name=null;this.page_div=null;this.store={};this._pagebar={};this.pagebar=true;this.pageSize=10;var t=false;this.tbar=null;this.cm={};this.cls="mwt-table";this.bordered=false;this.multiSelect=false;var i=false;var r=null;var s=this;if(e){if(e.render)this.render=e.render;if(e.cm)this.cm=e.cm;if(e.cls)this.cls=e.cls;if(e.store){this.store=e.store;var s=this;this.store.on("load",function(e){s.display()})}if(isset(e.pagebar))this.pagebar=e.pagebar;if(isset(e.pageSize))this.pageSize=e.pageSize;if(isset(e.multiSelect))this.multiSelect=e.multiSelect;if(isset(e.tbar))this.tbar=e.tbar;if(e.bordered)this.bordered=true;if(e.noheader)i=true;if(e.rowclick)r=e.rowclick;if(e.pagebarSimple)t=true}this.create=function(){this.grid_div="grid_div_"+e.render;this.page_div="page_div_"+e.render;this.grid_chkbox_id=this.grid_div+"-chkbox-id";this.grid_chkbox_name=this.grid_div+"-chkbox";var r="<div class='mwt-grid'";if(this.tbar){r+="><div id='tbar_div_"+e.render+"'></div>"}else{r+=" style='border-top:solid 0px #ccc;'>"}var s=this.cm.getColumns();r+="<table class='tab";if(this.bordered)r+=" bordered";if(!this.pagebar)r+=" nobbar";r+="'>";if(!i){r+="<thead><tr>";if(this.multiSelect)r+="<td style='width:20px;text-align:center;'>"+"<input id='"+this.grid_chkbox_id+"' type='checkbox' "+"onchange='set_checkbox_checked(\""+this.grid_chkbox_name+"\",this.checked);'/></td>";var a=s.length;for(var n=0;n<a;++n){if(s[n].hide){continue}var l="";if(s[n].width){l="width='"+s[n].width+"'"}var o=this.grid_div+"-"+s[n].dataIndex+"-"+n;r+="<td "+l+" id='"+o+"' name='"+this.grid_div+"-th' ";if(isset(s[n].align))r+="align='"+s[n].align+"' ";if(isset(s[n].valign))r+="valign='"+s[n].valign+"' ";if(isset(s[n].style))r+="style='"+s[n].style+"' ";if(s[n].sort)r+="class='grid-sort' ";r+="data-id='"+s[n].dataIndex+"'>"+s[n].head+"</td>"}r+="</tr></thead>"}r+="<tbody id='"+this.grid_div+"'></tbody></table>";if(this.pagebar)r+="<div id='"+this.page_div+"' style='background:#f9f9f9;padding:5px;'></div>";r+="</div>";jQuery("#"+this.render).html(r);if(!i){this.initevent()}if(this.tbar){var d=new MWT.Bar({render:"tbar_div_"+e.render,items:this.tbar});d.create()}if(this.pagebar){this._pagebar=new MWT.Pagebar({store:this.store,render:this.page_div,pageSize:this.pageSize,simple:t})}};this.getRecord=function(e,t){var i=this.store.indexOf(e,t);if(i<0||i>=this.store.size()){return null}return this.store.get(i)};this.load=function(e){if(isset(e))this.store.baseParams=e;if(this.pagebar)this._pagebar.changePage(1);else this.store.load()};this.display=function(){if(!this.render){return}if(!this.grid_div){this.create()}var e=this.cm.getColumns();var t=e.length;var i="";var a=this.store.size();var n=this.render+"row";for(var l=0;l<a;++l){var o=this.store.get(l);o.store_index=l;i+="<tr name='"+n+"' data-idx='"+l+"'>";if(this.multiSelect)i+="<td align='center'><input name='"+this.grid_chkbox_name+"' value='"+l+"' type='checkbox'/></td>";for(var d=0;d<t;++d){if(e[d].hide){continue}var h=e[d].dataIndex;var u=o[h];if(e[d].render){var c=e[d].render;u=c(u,o)}i+="<td ";var f="";if(e[d].width){i+="width='"+e[d].width+"' "}if(isset(e[d].align))i+="align='"+e[d].align+"' ";if(isset(e[d].valign))i+="valign='"+e[d].valign+"' ";if(isset(e[d].style))i+="style='"+e[d].style+"' ";i+=">"+u+"</td>"}i+="</tr>"}jQuery("#"+this.grid_div).html(i);if(r){jQuery("[name="+n+"]").unbind("click").click(function(){var e=jQuery(this).data("idx");var t=s.store.get(e);r(t)})}};this.getSelectedRecords=function(){var e=get_checkbox_values(this.grid_chkbox_name);var t=[];for(var i=0;i<e.length;++i){var r=this.store.get(e[i]);r.store_index=e[i];t.push(r)}return t};this.initevent=function(){var e=this.cm.getColumns();var t=e.length;for(var i=0;i<t;++i){if(!e[i].sort){continue}var r=this.grid_div+"-"+e[i].dataIndex+"-"+i;document.getElementById(r).onclick=function(){var e=this.getAttribute("data-id");var t=0;if(this.hasAttribute("data-sort"))t=this.getAttribute("data-sort");t=1-t;this.setAttribute("data-sort",t);var i=document.getElementsByName(s.grid_div+"-th");for(var r=0;r<i.length;++r){removeClass(i[r],"grid-sort-asc");removeClass(i[r],"grid-sort-desc")}addClass(this,t==1?"grid-sort-asc":"grid-sort-desc");var a=t==1?"ASC":"DESC";s.store.baseParams["sort"]=e;s.store.baseParams["dir"]=a;s.load()}}}};MWT.extends(MWT.Grid,MWT.Event);MWT.Grid.ColumnModel=function(e){this.columns=[];if(e){this.columns=e}this.getColumns=function(){return this.columns}};MWT.Nav=function(e){this.listeners={};this.render=null;this.items=[];this.cls="";this.style="";if(e){if(e.render)this.render=e.render;if(e.items)this.items=e.items;if(e.cls)this.cls=e.cls;if(e.style)this.style=e.style}this.create=function(){var e=this.render+"-ul";var t='<ul id="'+e+'" class="mwt-nav '+this.cls+'">';for(var i=0;i<this.items.length;++i){var r=this.items[i];var s=r.href?r.href:"javascript:void(0);";var a=r.target?'target="'+r.target+'"':"";t+='<li><a href="'+s+'" data-idx="'+i+'" '+a+' style="'+this.style+'">'+r.title+"</a></li>"}t+="</ul>";jQuery("#"+this.render).html(t);var n=this;jQuery("#"+e).children("li").children("a").click(function(){var t=jQuery(this).data("idx");var i=n.items[t];if(i.target!="_blank"){jQuery("#"+e).children("li").removeClass("mwt-active");jQuery(this).parent().addClass("mwt-active");if(i.handler){i.handler()}}})};this.active=function(e){var t=this.render+"-ul";jQuery("#"+t).children("li").removeClass("mwt-active");jQuery("#"+t).children("li:eq("+e+")").addClass("mwt-active")}};MWT.extends(MWT.Bar,MWT.Event);MWT.Dialog=function(e){this.listeners={};var t="新建窗口";var i=null;var r="";var s="";var a="";var n=null;var l="bounceInDown";var o="500px";var d="auto";var h=100;var u=false;var c=null;var f;var v=null;var m;if(e){if(e.render)n=e.render;if(e.title)t=e.title;if(e.width)o=e.width+"px";if(e.height)d=e.height+"px";if(e.top)h=e.top;if(e.form)f=e.form;if(e.buttons)c=e.buttons;if(e.animate)l=e.animate;if(e.body)v=e.body;if(e.bodyStyle)m=e.bodyStyle;if(e.fullscreen)u=true}function p(e){if(e.which!=1)return;var t=document.getElementById(r);t.style.cursor="move";jQuery("#"+r).data("mdown","1");jQuery("#"+r).data("objX",t.style.left);jQuery("#"+r).data("objY",t.style.top);jQuery("#"+r).data("mouseX",e.clientX);jQuery("#"+r).data("mouseY",e.clientY)}function g(e){if(e.which!=1)return;if(jQuery("#"+r).data("mdown")==1){var t=jQuery("#"+r).data("objX");var i=jQuery("#"+r).data("objY");var s=jQuery("#"+r).data("mouseX");var a=jQuery("#"+r).data("mouseY");var n=document.getElementById(r);var l=e.clientX;var o=e.clientY;n.style.left=parseInt(t)+parseInt(l)-parseInt(s)+"px";n.style.top=parseInt(i)+parseInt(o)-parseInt(a)+"px"}}function y(e){if(e.which!=1)return;var t=document.getElementById(r);t.style.cursor="default";jQuery("#"+r).data("mdown","0")}this.create=function(){if(!n)n=MWT.gen_domid("dg-");MWT.create_div(n);i=MWT.$(n);i.className="mwt-dialog";if(v)i.innerHTML=v;var e=this;var b=n;r=b+"-dialog-body";s=b+"-dialog-title";a=b+"-dialog-content";a_close_id=b+"-close";var w=i.innerHTML;if(u){var x="<div id='"+n+"-modal' class='modaldiv'></div>"+"<div id='"+r+"' class='dialog-body "+l+"' "+"style='position:fixed;top:0;bottom:0;left:0;right:0;display:block;'>"+"<div class='dialog-head' id='d-head-"+b+"'>"+"<span id='"+s+"'>"+t+"</span>"+"<a id='"+a_close_id+"' class='mwt-btn mwt-btn-default mwt-btn-xs radius btnclose' href='javascript:;'> × </a>"+"</div>"+"<div class='content' onmousedown='' style='height:"+d+";"+m+"' id='"+a+"'>"+w+"</div>"}else{var x="<div id='"+n+"-modal' class='modaldiv'></div>"+"<div id='"+r+"' class='dialog-body "+l+"' style='top:"+h+"px;width:"+o+"'>"+"<div class='dialog-head' id='d-head-"+b+"'>"+"<span id='"+s+"'>"+t+"</span>"+"<a id='"+a_close_id+"' class='mwt-btn mwt-btn-default mwt-btn-xs radius btnclose' href='javascript:;'> × </a>"+"</div>"+"<div class='content' onmousedown='' style='height:"+d+";"+m+"' id='"+a+"'>"+w+"</div>"}if(c&&c.length>0){x+="<div id='d-foot-"+b+"' class='dialog-foot'>";for(var T=0;T<c.length;T++){var j=isset(c[T].cls)?c[T].cls:"mwt-btn-default";x+=" <button class='mwt-btn "+j+" mwt-btn-sm' style='border-radius:2px;' id='"+b+T+"btn'>"+c[T].label+"</button>"}x+="&nbsp;</div>"}x+="</div></div>";i.innerHTML=x;if(isset(f)){f.create()}jQuery("#"+a_close_id).click(function(){e.close()});if(c&&c.length>0){for(var T=0;T<c.length;T++){var Q=b+T+"btn";if(c[T].type=="close"){jQuery("#"+Q).click(function(){e.close()})}else if(isset(c[T].handler)){jQuery("#"+Q).click(c[T].handler)}}}jQuery("#d-head-"+b).mousedown(p).mousemove(g).mouseup(y)};this.open=function(){if(i==null)this.create();this.fire("beforeOpen");jQuery("#"+n).show();jQuery("#"+n+"-modal").fadeIn("fast");jQuery("#"+r).css("display","inline-block");this.fire("open")};this.close=function(){this.fire("beforeClose");jQuery("#"+n).fadeOut("fast");this.fire("close")};this.setTitle=function(e){t=e;if(i)MWT.$(s).innerHTML=t}};MWT.extends(MWT.Dialog,MWT.Event);mwt.notify=function(e,t,i){var r=mwt.create_div("mwt-notify-container");if(e){var s=mwt.gen_domid("mwt-notify-div-");if(!i)i="";var a="";switch(i){case"info":a="fa fa-info-circle";break;case"warning":a="fa fa-warning";break;case"danger":a="fa fa-times-circle";break;case"success":a="fa fa-check-circle";break;case"loading":a="fa fa-circle-o-notch fa-spin fa-3x fa-fw";break}if(i!="")a='<i class="'+a+'"></i>';var n='<div id="'+s+'"><div class="mwt-notify '+i+' zoomIn">'+a+e+"</div></div>";jQuery("#"+r).append(n);if(t>0){setTimeout(function(){mwt.notify_destroy(s)},t)}return s}return null};mwt.notify_destroy=function(e){jQuery("#"+e).fadeOut("slow");setTimeout(function(){mwt.destroy(e)},2e3)};mwt.notify_clearall=function(){jQuery("#mwt-notify-container").html("")};mwt.stop_progress=false;mwt.progress_color="#09C";mwt.show_progress=function(e){var t=MWT.create_div("mwt-progress-div");var i="loading-progress-span";if(!document.getElementById(i)){var r="<span id='loading-progress-span' "+"style='top:0;left:0px;width:0%;height:2px;position:absolute;z-index:999;border-radius:2px;background-color:"+MWT.progress_color+";'></span>";jQuery("#"+t).html(r);jQuery("#"+t).fadeIn("fast");MWT.stop_progress=false;e=0}else{if(!e)return}if(MWT.stop_progress){jQuery("#"+t).html("");return}if(e<=90){var s=Math.random()*100%6;e+=s;var a=jQuery("#loading-progress-span").css("width");var n={width:e+"%"};jQuery("#loading-progress-span").animate(n)}setTimeout(function(){MWT.show_progress(e)},500)};mwt.hide_progress=function(){var e={width:"100%"};jQuery("#loading-progress-span").animate(e,function(){jQuery("#mwt-progress-div").hide();MWT.stop_progress=true})};MWT.alert=function(e,t){if(!e)return;var i=MWT.create_div("mwt-alert-msg-div");var r=e.msg?e.msg:e;var s="<div style=\"padding:30px 40px;font-size:13px;font-family:'microsoft yahei';\">"+r+"</div>";jQuery("#"+i).html(s);var a=new MWT.Dialog({render:"mwt-alert-msg-div",title:e.title?e.title:"消息提示",width:400,top:e.top?e.top:50,animate:e.animate?e.animate:"bounceInDown",buttons:[{label:"确定",cls:"mwt-btn-primary",type:"close"}]});a.open();if(t)a.on("close",t)};MWT.confirm=function(e,t){if(!e)return;var i=MWT.create_div("mwt-confirm-msg-div");var r=e.msg?e.msg:e;var s="<div style=\"padding:30px 40px;font-size:13px;font-family:'microsoft yahei';\">"+r+"</div>";jQuery("#"+i).html(s);var a=new MWT.Dialog({render:"mwt-confirm-msg-div",title:e.title?e.title:"请确认",width:400,top:e.top?e.top:50,animate:e.animate?e.animate:"bounceInDown",buttons:[{label:"取消",cls:"mwt-btn-default",handler:function(){a.close();t(false)}},{label:"确认",cls:"mwt-btn-primary",handler:function(){a.close();t(true)}}]});a.open()};